<!DOCTYPE html><html lang="ru"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>BoomPoint — бонусы и игра</title><style>*{box-sizing:border-box}body{font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif;margin:0;color:#111;background:#fafafa}.container{max-width:880px;margin:0 auto;padding:24px}.lead{color:#555}.card{background:#fff;border:1px solid #eee;border-radius:12px;padding:20px;margin:16px 0;box-shadow:0 1px 3px rgba(0,0,0,.03)}.row{display:flex;gap:12px;align-items:center;margin:10px 0}.row input[type=text],.row input[type=email],.row input[readonly]{flex:1;padding:10px 12px;border:1px solid #ddd;border-radius:8px}.checkbox{gap:8px}button{padding:10px 14px;border-radius:10px;border:1px solid #222;background:#111;color:#fff;cursor:pointer}button:disabled{opacity:.6;cursor:not-allowed}.muted{color:#666}.stats{display:flex;gap:16px}.stat{background:#f7f7f8;border:1px solid #eee;border-radius:12px;padding:14px 18px;display:flex;flex-direction:column;align-items:flex-start}.stat span{font-size:24px;font-weight:700}.progress-wrap{margin:16px 0}.progress{height:12px;background:#eee;border-radius:99px;overflow:hidden}#progressBar{height:100%;width:0%;background:linear-gradient(90deg,#7dd3fc,#34d399);transition:width .35s ease}.progress-label{font-size:12px;color:#555;margin-top:6px}.share .row{align-items:stretch}.share input{background:#f7f7f8}.share-buttons a{display:inline-block;padding:8px 12px;border:1px solid #ddd;border-radius:10px;margin-right:8px;text-decoration:none;color:#111}.quests{list-style:none;padding-left:0}.quests li{display:flex;justify-content:space-between;align-items:center;padding:10px;border:1px solid #eee;border-radius:10px;margin:8px 0}.leaderboard{padding-left:22px}nav a{text-decoration:none;color:#111;padding:6px 10px;border-radius:8px;border:1px solid #eee;background:#fff}nav a:hover{background:#f7f7f8}</style><script>window.BOOMPOINT_API='';</script></head><body><header class="container"><h1>BoomPoint</h1><p class="lead">Копи баллы, выполняй квесты, зови друзей. Всё просто.</p><nav style="display:flex; gap:12px; align-items:center; margin-top:8px;"><a href="#signup" onclick="route()">Регистрация</a><a href="#login" onclick="route()">Вход</a></nav></header><main class="container"><section id="signup" class="card"><h2>Начни за 10 секунд</h2><div class="row"><label for="name">Имя</label><input id="name" placeholder="Иван"/></div><div class="row"><label for="email">Email</label><input id="email" type="email" placeholder="you@example.com"/></div><div class="row checkbox"><input id="consent" type="checkbox"/><label for="consent">Согласен(на) с условиями и обработкой данных</label></div><input type="hidden" id="refHidden"/><button type="button" onclick="signup()">Зарегистрироваться</button><p id="signupMsg" class="muted"></p></section><section id="login" class="card" hidden><h2>Войти</h2><div class="row"><label for="loginEmail">Email</label><input id="loginEmail" type="email" placeholder="you@example.com"/></div><button type="button" onclick="startLogin()">Отправить код</button><div id="verifyBlock" hidden><div class="row"><label for="otp">Код из письма</label><input id="otp" inputmode="numeric" pattern="[0-9]*" placeholder="123456"/></div><button type="button" onclick="verifyLogin()">Подтвердить</button></div><p id="loginMsg" class="muted"></p></section><section id="dashboard" class="card" hidden><h2>Твой кабинет</h2><div class="stats"><div class="stat"><span id="balance">0</span><small>баллов</small></div><div class="stat"><span id="level">1</span><small>уровень</small></div><div class="stat"><span id="streak">0</span><small>дней серии</small></div></div><div class="progress-wrap"><div class="progress"><div id="progressBar"></div></div><div class="progress-label"><span id="progressText">0 / 100 до след. уровня</span></div></div><div class="share"><h3>Пригласи друзей</h3><p>За приглашённого друга после подтверждения email: <b>+200</b> тебе и <b>+50</b> другу.</p><div class="row"><input id="refLink" readonly/><button type="button" onclick="copyRef()">Скопировать</button></div><div class="share-buttons"><a id="shareTelegram" target="_blank" rel="noopener">Telegram</a><a id="shareWhatsApp" target="_blank" rel="noopener">WhatsApp</a><a id="shareVK" target="_blank" rel="noopener">VK</a></div></div><div class="actions"><button type="button" onclick="doDaily()">Ежедневный вход</button><button type="button" onclick="doVerify()">Подтвердить email</button></div><h3>Квесты</h3><ul id="quests" class="quests"></ul><h3>Топ недели</h3><ol id="leaderboard" class="leaderboard"></ol></section></main><footer class="container muted"><p>BoomPoint · v1.0 (Render API)</p></footer><script>const API=window.BOOMPOINT_API||'';const $=s=>document.querySelector(s);const fmt=n=>new Intl.NumberFormat('ru-RU').format(n);function show(id){['signup','login','dashboard'].forEach(s=>{const el=$('#'+s);if(el)el.hidden=s!==id})}function route(){const me=localStorage.getItem('bp_me');if(me){show('dashboard');loadMe();return}const h=(location.hash||'').replace('#','');if(h==='login')show('login');else show('signup')}function initRef(){const url=new URL(window.location.href);const ref=url.searchParams.get('ref');if(ref)localStorage.setItem('bp_ref',ref);const stored=localStorage.getItem('bp_ref');if(stored)$('#refHidden').value=stored}function levelFromPoints(p){let l=1,n=100;while(p>=n){p-=n;l++;n=100+50*Math.pow(l-1,2)}return{level:l,progress:p,nextNeed:n}}function hydrate(user){if(!user)return;localStorage.setItem('bp_me',user.id);localStorage.setItem('bp_code',user.code||'');$('#balance').textContent=fmt(user.balance||0);const lv=levelFromPoints(user.balance||0);$('#level').textContent=lv.level;const pct=Math.max(0,Math.min(100,Math.round(lv.progress/lv.nextNeed*100)));$('#progressBar').style.width=pct+'%';$('#progressText').textContent=fmt(lv.progress)+' / '+fmt(lv.nextNeed)+' до след. уровня';const myLink=location.origin+'/?ref='+user.code;$('#refLink').value=myLink;$('#shareTelegram').href='https://t.me/share/url?url='+encodeURIComponent(myLink)+'&text='+encodeURIComponent('Залетай в BoomPoint!');$('#shareWhatsApp').href='https://api.whatsapp.com/send?text='+encodeURIComponent('Залетай в BoomPoint: '+myLink);$('#shareVK').href='https://vk.com/share.php?url='+encodeURIComponent(myLink);fetch(API+'/api/leaderboard').then(r=>r.json()).then(d=>{const ol=$('#leaderboard');ol.innerHTML='';(d.top||[]).forEach(t=>{const li=document.createElement('li');li.textContent=(t.name||'Игрок')+' — '+fmt(t.score||0);ol.appendChild(li)})});show('dashboard')}async function loadMe(){const id=localStorage.getItem('bp_me');if(!id)return;const w=await fetch(API+'/api/wallet/'+id).then(r=>r.json());hydrate({id,balance:w.balance||0,code:localStorage.getItem('bp_code')||''})}async function signup(){const name=$('#name').value.trim();const email=$('#email').value.trim();const consent=$('#consent').checked;const ref=$('#refHidden').value.trim();if(!name)return alert('Введите имя');if(!email||!email.includes('@'))return alert('Введите корректный email');if(!consent)return alert('Поставьте галочку согласия');$('#signupMsg').textContent='Создаём аккаунт...';const res=await fetch(API+'/api/signup',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({name,email,ref})});const data=await res.json();if(!res.ok){$('#signupMsg').textContent='Ошибка: '+(data.error||'');return}$('#signupMsg').textContent='Готово!';hydrate(data);history.pushState('',document.title,window.location.pathname)}async function startLogin(){const email=$('#loginEmail').value.trim();$('#loginMsg').textContent='Отправляем код...';const res=await fetch(API+'/api/login/start',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({email})});const data=await res.json();if(!res.ok||!data.ok){$('#loginMsg').textContent='Ошибка: '+(data.error||'');return}$('#verifyBlock').hidden=false;$('#loginMsg').textContent='Код отправлен на email.'}async function verifyLogin(){const code=$('#otp').value.trim();$('#loginMsg').textContent='Проверяем код...';const res=await fetch(API+'/api/login/verify',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({code})});const data=await res.json();if(!res.ok||!data.ok){$('#loginMsg').textContent='Ошибка: '+(data.error||'');return}hydrate(data.user);location.hash=''}async function doVerify(){const id=localStorage.getItem('bp_me');if(!id)return;const res=await fetch(API+'/api/verify-email',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({user_id:id})});const data=await res.json();if(!res.ok)return alert('Ошибка');alert('Email подтверждён. Баланс: '+data.balance);loadMe()}async function doDaily(){const id=localStorage.getItem('bp_me');const res=await fetch(API+'/api/event',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({user_id:id,action:'daily_checkin'})});const data=await res.json();if(data.ok){alert('+'+data.bonus+' за вход. Серия: '+data.streak);loadMe()}else{alert('Сегодня уже отмечено')}}function copyRef(){const v=$('#refLink').value;navigator.clipboard.writeText(v).then(()=>alert('Ссылка скопирована!')).catch(()=>{})}const QUESTS=[{id:'fill_profile',title:'Заполнить профиль',points:30,once:true},{id:'share_social',title:'Поделиться ссылкой (1 раз в день)',points:5,daily:true},{id:'give_feedback',title:'Оставить отзыв',points:30,once:true}];function renderQuests(){const ul=$('#quests');ul.innerHTML='';QUESTS.forEach(q=>{const li=document.createElement('li');li.innerHTML='<span>'+q.title+' · +'+q.points+'</span><button type="button">Сделано</button>';li.querySelector('button').onclick=()=>alert('Квесты подключим к API позже.');ul.appendChild(li)})}document.addEventListener('DOMContentLoaded',()=>{initRef();route();renderQuests();const me=localStorage.getItem('bp_me');if(me){loadMe()}window.addEventListener('hashchange',route)});</script></body></html>